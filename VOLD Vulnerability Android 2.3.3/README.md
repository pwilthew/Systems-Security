# Exploiting Vold Vulnerability in Android 2.3.3

In this assignment, I am going to write an exploit to gain root privilege on an Android 2.3.3 device through the Volume Daemon vulnerability.


## Vulnerability

The vulnerable Volume Manager Daemon (Vold) on Android 2.3.3 trusts messages that are received from a PF_NETLINK socket without checking the integrity of messages. This allows local users to execute arbitrary code and gain root privilege via a negative index that is passed to the DirectVolume::handlePartitionAdded method.


## Goal

Gain a root privileged shell on the Android 2.3.3 ARM emulator using the method discussed in class.


## Vold

A Vold monitor kernel Uevent looks like this:

Inserting an SD card, for example
```
Uevent: 
ACTION=add
DEVPATH=/devices/platform/msm_sdcc.2/mmc_host/mmc11:c9f2/block/mmcblk0
SUBSYSTM=block
MAJOR=179
MINOR=0
...
..
.
```

And the `DirectVolume::handlePartitionAdded method` looks like this:

![handlePartitionAdded](images/HandlePartitionAdded.png)


